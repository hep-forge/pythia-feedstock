{% set versions = {
    "8.3.12": "c1a33aa5fa15e6b70d7946ce6d237246842887ec84ea0b35dfc2535c868a2770"
} %}


{% set version = environ.get('COMMIT_VERSION', None) %}
{% set version = version or versions.keys()|first %}
{% set version = version|string %}

{% set gnu_min_versions = {
      "8.3.12": "14"
} %}
{% set _gnu_major = gnu_min_versions.get(version, "") %}
{% set gnu_pin    = (" " ~ _gnu_major ~ ".*") if _gnu_major else "" %}

package:
  name: {{ environ.get('ANACONDA_PACKAGE', "pythia")|string|lower }}
  version: {{ environ.get('ANACONDA_VERSION', version)|replace("-", ".") }}

source:
  url: "https://gitlab.com/Pythia8/releases/-/archive/pythia8312/releases-pythia{{ version|replace(".", "") }}.tar.gz"
  {% if versions.get(version, None) %}
  sha256: {{ versions.get(version) }}
  {% endif %}

requirements:
  build:
    - {{ compiler('gfortran') }}{{ gnu_pin }}
    - {{ compiler('cxx') }}{{ gnu_pin }}
    - {{ compiler('c') }}{{ gnu_pin }}
    - make

  run:
    - {{ stdlib("c") }}

  run_constrained:
    - pythia8 <0

build:
  # Let dependents float upward too (no max pin)
  run_exports:
    - libgcc-ng    >={{ _gnu_major }}           # [linux]
    - libstdcxx-ng >={{ _gnu_major }}           # [linux]
    - libgfortran5 >={{ _gnu_major }}           # [linux]

about:
  home: "https://pythia.org"
  license: "GPL-3.0"
  summary: "PYTHIA is a program for the generation of high-energy physics collision events, i.e. for the description of collisions at high energies between electrons, protons, photons and heavy nuclei."

extra:
  recipe-maintainers:
    - meiyasan
